<app-map-list class="map-list" [showActions]="false" [onlyVisible]="true" (divClicked)="openPopup()"></app-map-list>
<!-- Popup -->
@if (isPopupVisible) {
<div class="popup">
  <div class="popup-content">
    <!-- Portrait Navigation -->

    <div class="portrait-container">
      <button class="arrow-button" (click)="navigatePortrait('prev')">←</button>
      <div class="portrait-display">
        <img [src]="getCurrentPortraitImage()" alt="Portrait" class="portrait-image" />
      </div>
      <button class="arrow-button" (click)="navigatePortrait('next')">→</button>
    </div>

    <!-- Name Input -->
    <div class="name-container">
      <label for="player-name">Who are you ?</label>
      <input type="text" id="player-name" [(ngModel)]="playerName" placeholder="Enter your name" class="name-input"
        maxlength="20" />
    </div>

    <!-- Stat Selection -->
    <div class="stat-container">
      <div class="tooltip">
        <button class="stat-button" [class.selected]="lifeSelected" (click)="selectLife()">
          Vie: {{ stats.life }}
        </button>
        <span class="tooltiptext">Augmente la vie de 2 points</span>
      </div>
      <div class="tooltip">
        <button class="stat-button" [class.selected]="rapiditySelected" (click)="selectRapidity()">
          Rapidité: {{ stats.rapidity }}
        </button>
        <span class="tooltiptext">Augmente la rapidité de 2 points</span>
      </div>
      <div class="tooltip">
        <button class="stat-button" [class.selected]="attackSelected" (click)="selectAttack()">
          Attaque: <img [src]="stats.attackDice" alt="Attack Dice" class="dice-image" />
        </button>
        <span class="tooltiptext">Augmente l'attaque à D6</span>
      </div>
      <div class="tooltip">
        <button class="stat-button" [class.selected]="defenseSelected" (click)="selectDefense()">
          Défense: <img [src]="stats.defenseDice" alt="Defense Dice" class="dice-image" />
        </button>
        <span class="tooltiptext">Augmente la défense à D6</span>
      </div>
    </div>

    <!-- Close Popup -->
    <button class="close-popup-button" (click)="closePopup()">Close</button>
    @if (areTwoStatsSelected()) {
    <button class="join-button" routerLink="/attente">Join</button>
    }
  </div>
</div>
}